# ====================================================================
# QD - D√©tection carte Wi-Fi visible mais absente de la pile IP
# ====================================================================

Write-Host "=== Analyse des interfaces r√©seau ===`n"

# 1Ô∏è‚É£ - Cartes physiques d√©tect√©es par le gestionnaire de p√©riph√©riques
$physical = Get-NetAdapter -Physical | Where-Object { $_.InterfaceDescription -match "Wi-Fi|Wireless|802.11" }

if ($physical) {
    foreach ($card in $physical) {
        Write-Host "Carte d√©tect√©e : $($card.Name) [$($card.InterfaceDescription)]"
        Write-Host " - Status OS  : $($card.Status)"
        Write-Host " - MAC        : $($card.MacAddress)"
        Write-Host " - GUID       : $($card.InterfaceGuid)"
        Write-Host ""
    }
} else {
    Write-Host "‚ùå Aucune carte Wi-Fi physique d√©tect√©e par le syst√®me." -ForegroundColor Red
}

# 2Ô∏è‚É£ - Interfaces IP reconnues par la pile r√©seau (ipconfig √©quivalent)
$ip = Get-NetIPConfiguration | Where-Object { $_.InterfaceAlias -match "Wi-Fi|Wireless|802.11" }

if ($ip) {
    Write-Host "=== Interfaces IP actives ===" -ForegroundColor Green
    $ip | ForEach-Object {
        Write-Host " - Interface : $($_.InterfaceAlias)"
        Write-Host "   IPv4      : $($_.IPv4Address.IPAddress)"
        Write-Host "   DNS       : $($_.DNSServer.ServerAddresses -join ', ')"
        Write-Host ""
    }
} else {
    Write-Host "‚ö†Ô∏è Aucune interface Wi-Fi n'est actuellement mont√©e dans la pile IP." -ForegroundColor Yellow
    Write-Host "(Sympt√¥me typique : NSI / IP Helper / Wcmsvc non initialis√©s)"
}

# 3Ô∏è‚É£ - R√©sum√© rapide
Write-Host "`n=== R√©sum√© ==="
if ($physical -and -not $ip) {
    Write-Host "üü† Carte Wi-Fi d√©tect√©e mat√©riellement mais absente de la pile IP ‚Äî pile r√©seau rompue." -ForegroundColor DarkYellow
} elseif (-not $physical) {
    Write-Host "üî¥ Aucune carte Wi-Fi d√©tect√©e ‚Äî probl√®me driver ou d√©sactivation mat√©rielle." -ForegroundColor Red
} else {
    Write-Host "üü¢ Carte Wi-Fi op√©rationnelle ‚Äî pile r√©seau active." -ForegroundColor Green
}
